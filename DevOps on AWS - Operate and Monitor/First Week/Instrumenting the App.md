![[index (5).mp4]]
So far, Raf has given us a great background on how to monitor AWS resources, from auditing to performance. But in this video, we'll discuss application monitoring. Take the following scenario. Let's say I create an application and run it on an EC2 instance. How do I monitor this application? I want to monitor things like application failures, make sure the app is running as expected. I also want to monitor the usage of the application and learn things like how many users are signing up, how many page views I'm getting, which part of my application is hitting limits, and also I want to learn any other business-relevant information. But because this data is so specific to my application and to my business, the CloudWatch built-in metrics for EC2 aren't going to be as comprehensive as I need them to be. Great for monitoring CPU usage and network packets coming in and out, but not going to work to calculate my user signups. So, what do I do? How do I collect this data that is so custom to my application?
# __
Well, this is why you need custom CloudWatch metrics. These are the metrics that are specific and important to your application. The best part is you can generate custom metrics by instrumenting them directly in your application code. So, if you're running an application on EC2, ECS, or even Lambda, you can use the put_metrics_data API call to write any custom metric you want. For example, here's a custom metric that gathers data on number of user signups. Once we have our metrics created, we can head to the CloudWatch console and visualize all the built-in and custom metrics that have been generated by our application. I can create line graphs and even visualize my data through a number, if I'd like, such as our page-view metric. I can see here that I've gotten a few user signups from me and a few of my friends.
# __
Now, these metrics are great. They provide me numeric data, like request rates, error rates, and more. But what if I want to see an end-to-end view of requests as they flow through my application to get a better idea of what the customer experience is like? Maybe I have an application that looks like this, API Gateway, a Lambda function, and a DynamoDB table. I want to see a single user's journey across these multiple stages to identify bottlenecks, latency spikes, and other issues I might need to solve in order to improve the performance of my application.
# __
Well, it turns out there's a service for that called AWS X-Ray. This service enables you to view requests as they go through your application and provides tools that let you view and understand that data to identify issues. If you want to enable X-Ray for Lambda and API Gateway, all you need to do is check a box in the console. If you want to use X-Ray with EC2, you'll need to install a daemon on the EC2 instance. However, once you enable X-Ray, you can begin to collect data from your application and services to generate what are called segments, which provide details about a request and details about the work done. These segments are then grouped into traces. Here's an example of what a trace looks like. You can see information about the request, response, and duration.
# __
These traces are then processed to generate a service map, which allow you to visualize each AWS resource that sends data to X-Ray in a graph. As a result, I can see my application I spoke about earlier visualized here. I have a node for my API, a node for my Lambda function, and a node for my DynamoDB table, all visualized. The more pieces I have of my application and the more complex and distributed it gets, the more helpful the service map becomes. If you want to use CloudWatch and X-Ray and don't want to go to two different places to see all of that data, there's another service that enables you to combine the two. You can use CloudWatch ServiceLens to view traces, metrics, logs, alarms, and other resource health information. That means it integrates both CloudWatch and X-Ray, so you can see observability information in just one place. ServiceLens also integrates with Amazon CloudWatch Synthetics, which is a fully managed service that enables you to create canaries to monitor your endpoints and APIs from the outside in. These canaries are simply just scripts that you write that run on a schedule. You can use them to mimic customer traffic as it flows through your application so that you can better verify that the customers are having a good experience with your app. The entire idea of this is that you discover issues before your customers do. All right, so lots of great features for monitoring, and we're going to take it a step further when we talk about network monitoring. See you soon.